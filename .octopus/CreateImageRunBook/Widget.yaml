sourceType: Backup
name: Widget
engine: mssql
version: 2022
tags:
- createdby_alexyates
- purpose_octopusdemo
- #{Octopus.RunbookRun.Id | ToLower | Replace "-" "_" }
# - #{Octopus.Web.ServerUri}/#{Octopus.Web.RunbookRunLink}
lifetime: 336h
backups:
  - path: mssql/Widget/WidgetProduction.bak
preScript: |
  CREATE DATABASE [Widget_Shadow]
postScript: |
  create login [Redgate]
  with password = N'Redg@te1'
    , default_database = [master]
    , default_language = [us_english]
    , check_expiration = off
    , check_policy = off;
  go

  alter server role [sysadmin] add member [Redgate];
  go

  use WidgetProduction
  create user [Redgate] for login [Redgate]
  go

  use Widget_Shadow
  create user [Redgate] for login [Redgate]
  go
